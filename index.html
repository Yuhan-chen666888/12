<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BMIè©¦ç®—è¡¨</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- å¼•å…¥ Chart.js -->
    <style>
        .container {
            max-width: 400px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            text-align: center;
        }
        input[type="number"], input[type="button"] {
            width: 100%;
            height: 40px;
            margin: 5px 0;
            font-size: 18px;
        }
        input[type="button"] {
            background-color: #4CAF50;
            color: white;
            border: none;
            cursor: pointer;
        }
        input[type="button"]:hover {
            background-color: #45a049;
        }
        #result, #suggestion {
            font-size: 18px;
            font-weight: bold;
            margin-top: 10px;
        }
        .history {
            margin-top: 20px;
            text-align: left;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #ccc;
            padding: 8px;
            text-align: center;
        }
        th {
            background-color: #f2f2f2;
        }
        canvas {
            max-width: 100%;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>BMIè©¦ç®—è¡¨</h2>
        <label for="height">èº«é«˜ (å…¬åˆ†):</label>
        <input type="number" id="height" placeholder="ä¾‹å¦‚: 170">
        <label for="weight">é«”é‡ (å…¬æ–¤):</label>
        <input type="number" id="weight" placeholder="ä¾‹å¦‚: 65">
        <input type="button" value="è¨ˆç®—BMI" onclick="calculateBMI()">
        <div id="result"></div>
        <div id="suggestion"></div>

        <!-- BMI ç­‰ç´šæ¨™æº– -->
        <h3>BMI ç­‰ç´šæ¨™æº–</h3>
        <table>
            <tr>
                <th>BMI ç¯„åœ</th>
                <th>ç‹€æ…‹</th>
            </tr>
            <tr><td>å°æ–¼ 18.5</td><td style="color: blue;">éè¼• ğŸŸ¡</td></tr>
            <tr><td>18.5 - 23.9</td><td style="color: green;">æ­£å¸¸ âœ…</td></tr>
            <tr><td>24 - 26.9</td><td style="color: orange;">éé‡ ğŸŸ </td></tr>
            <tr><td>27 ä»¥ä¸Š</td><td style="color: red;">è‚¥èƒ– ğŸ”´</td></tr>
        </table>

        <!-- BMI æ­·å²ç´€éŒ„ -->
        <div class="history">
            <h3>æ­·å²ç´€éŒ„</h3>
            <table id="historyTable">
                <tr>
                    <th>èº«é«˜ (cm)</th>
                    <th>é«”é‡ (kg)</th>
                    <th>BMI</th>
                    <th>ç‹€æ…‹</th>
                </tr>
            </table>
        </div>

        <!-- BMI åœ–è¡¨ -->
        <canvas id="bmiChart"></canvas>
    </div>

    <script>
        let bmiHistory = [];
        let chart = null;

        function calculateBMI() {
            let height = document.getElementById('height').value / 100; // è½‰æ›ç‚ºå…¬å°º
            let weight = document.getElementById('weight').value;
            let result = document.getElementById('result');
            let suggestion = document.getElementById('suggestion');

            if (height > 0 && weight > 0) {
                let bmi = weight / (height * height);
                let status = '';
                let color = '';

                if (bmi < 18.5) {
                    status = 'éè¼• ğŸŸ¡';
                    color = 'blue';
                } else if (bmi < 24) {
                    status = 'æ­£å¸¸ âœ…';
                    color = 'green';
                } else if (bmi < 27) {
                    status = 'éé‡ ğŸŸ ';
                    color = 'orange';
                } else {
                    status = 'è‚¥èƒ– ğŸ”´';
                    color = 'red';
                }

                result.innerText = `æ‚¨çš„ BMI ç‚º: ${bmi.toFixed(2)}ï¼Œå±¬æ–¼ ${status}`;
                result.style.color = color;

                // è¨ˆç®—ç†æƒ³é«”é‡ç¯„åœ
                let minIdealWeight = (18.5 * (height * height)).toFixed(1);
                let maxIdealWeight = (23.9 * (height * height)).toFixed(1);
                
                if (bmi < 18.5) {
                    let gainWeight = (minIdealWeight - weight).toFixed(1);
                    suggestion.innerText = `ğŸ‘‰ å»ºè­°å¢åŠ è‡³å°‘ ${gainWeight} å…¬æ–¤ï¼Œä»¥é”åˆ°å¥åº·ç¯„åœ (${minIdealWeight} - ${maxIdealWeight} kg)`;
                    suggestion.style.color = 'blue';
                } else if (bmi >= 24) {
                    let loseWeight = (weight - maxIdealWeight).toFixed(1);
                    suggestion.innerText = `ğŸ‘‰ å»ºè­°æ¸›å°‘è‡³å°‘ ${loseWeight} å…¬æ–¤ï¼Œä»¥é”åˆ°å¥åº·ç¯„åœ (${minIdealWeight} - ${maxIdealWeight} kg)`;
                    suggestion.style.color = 'red';
                } else {
                    suggestion.innerText = `ğŸ‘ æ‚¨çš„é«”é‡å·²åœ¨å¥åº·ç¯„åœå…§ (${minIdealWeight} - ${maxIdealWeight} kg)`;
                    suggestion.style.color = 'green';
                }

                // æ–°å¢åˆ°æ­·å²ç´€éŒ„
                bmiHistory.push({ height: height * 100, weight, bmi: bmi.toFixed(2), status });
                updateHistoryTable();
                updateChart();
            } else {
                result.innerText = 'è«‹è¼¸å…¥æœ‰æ•ˆçš„èº«é«˜å’Œé«”é‡';
                result.style.color = 'black';
                suggestion.innerText = '';
            }
        }

        function updateHistoryTable() {
            let historyTable = document.getElementById('historyTable');
            historyTable.innerHTML = `
                <tr>
                    <th>èº«é«˜ (cm)</th>
                    <th>é«”é‡ (kg)</th>
                    <th>BMI</th>
                    <th>ç‹€æ…‹</th>
                </tr>`;

            bmiHistory.forEach(entry => {
                let row = `<tr>
                    <td>${entry.height}</td>
                    <td>${entry.weight}</td>
                    <td>${entry.bmi}</td>
                    <td>${entry.status}</td>
                </tr>`;
                historyTable.innerHTML += row;
            });
        }

        function updateChart() {
            let ctx = document.getElementById('bmiChart').getContext('2d');
            let labels = bmiHistory.map((_, index) => `è¨˜éŒ„ ${index + 1}`);
            let data = bmiHistory.map(entry => entry.bmi);

            if (chart) {
                chart.destroy();
            }

            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'BMI è®ŠåŒ–è¶¨å‹¢',
                        data: data,
                        borderColor: 'blue',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: false,
                            suggestedMin: 10,
                            suggestedMax: 40
                        }
                    }
                }
            });
        }
    </script>

</body>
</html>

